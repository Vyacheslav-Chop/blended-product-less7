{"version":3,"file":"index.js","sources":["../src/js/handlers.js","../src/js/storage.js","../src/js/modal.js","../src/home.js"],"sourcesContent":["// Функції, які передаються колбеками в addEventListner\nimport { refs } from './refs';\nimport {\n  fetchProducts,\n  fetchCategoryProducts,\n  fetchSearchResults,\n} from './products-api';\nimport {\n  updateActiveCategoryBtn,\n  clearContent,\n  showErrorMessage,\n  showInfoMessage,\n  smoothScroll,\n  hideLoadMoreBtn,\n  checkEndOfCollection,\n  appendProducts,\n} from './helpers';\nimport { renderProducts } from './render-function';\nimport {\n  closeModal,\n  handleAddToCart,\n  handleAddToWishList,\n  handleRemoveFromWishList,\n} from './modal';\nimport { STORAGE_KEYS } from './constants';\n\nconst { homeCategories, homeProducts, notFoundDiv, form } = refs;\nconst { cart, wishlist } = STORAGE_KEYS;\nlet query = '';\nlet currentPage = 1;\nlet category = '';\n// вивід списку продуктів за категорією\nexport async function showProducts(ev) {\n  if (!ev.target.classList.contains('categories__btn')) return;\n  category = ev.target.textContent.trim();\n\n  updateActiveCategoryBtn(homeCategories, ev.target);\n  currentPage = 1;\n  clearContent(homeProducts);\n\n  try {\n    let data;\n    if (category === 'All') {\n      data = await fetchProducts(currentPage);\n    } else {\n      data = await fetchCategoryProducts(category, currentPage);\n    }\n\n    const { products, total } = data;\n\n    if (products.length === 0) {\n      notFoundDiv.classList.add('not-found--visible');\n    } else {\n      appendProducts(homeProducts, products);\n\n      checkEndOfCollection(total, currentPage);\n    }\n  } catch (error) {\n    console.error(\"Oops! Couldn't fetch products:\", error);\n    showErrorMessage(\n      \"Oops! Couldn't fetch products. Check your connection or try again.\"\n    );\n  }\n}\n// пошук продуктів форми пошуку\nexport async function searchProduct(event) {\n  event.preventDefault();\n  currentPage = 1;\n  clearContent(homeProducts);\n\n  query = form.elements['searchValue'].value.trim();\n  if (!query) {\n    showErrorMessage('Please fill in the search field!');\n    return;\n  }\n\n  try {\n    const { products, total } = await fetchSearchResults(query, currentPage);\n\n    if (products.length === 0) {\n      renderProducts();\n      showErrorMessage('Unfortunately, no results were found for this query.');\n      return;\n    }\n    appendProducts(homeProducts, products);\n    checkEndOfCollection(total, currentPage);\n  } catch (error) {\n    console.error('An error occurred while searching for products:', error);\n    showErrorMessage(\n      'An error occurred while searching for products. Please try again later.'\n    );\n  } finally {\n    form.reset();\n  }\n}\n// закриття модалки кнопкою\nexport function handleModalClick(ev) {\n  const closeBtn = ev.target.closest('.modal__close-btn');\n  const addToCartBtn = ev.target.closest('.modal-product__btn--cart');\n  const addToWishListBtn = ev.target.closest('.modal-product__btn--wishlist');\n  if (closeBtn) {\n    closeModal();\n    return;\n  } else if (addToCartBtn) {\n    handleAddToCart(ev);\n    return;\n  } else if (addToWishListBtn) {\n    if (addToWishListBtn.textContent === 'Add to Wishlist') {\n      handleAddToWishList(ev);\n      return;\n    } else if (addToWishListBtn.textContent === 'Remove from Wishlist') {\n      handleRemoveFromWishList(ev);\n      return;\n    }\n    return;\n  }\n}\n// показати більше\nexport async function handleLoadMore(ev) {\n  const loadMoreBtn = ev.currentTarget;\n  if (!loadMoreBtn) return;\n\n  currentPage++;\n  loadMoreBtn.disabled = true;\n  hideLoadMoreBtn();\n  try {\n    let data;\n    if (query) {\n      data = await fetchSearchResults(query, currentPage);\n    } else if (category) {\n      if (category === 'All') {\n        data = await fetchProducts(currentPage);\n      } else {\n        data = await fetchCategoryProducts(category, currentPage);\n      }\n    } else {\n      data = await fetchProducts(currentPage);\n    }\n    const { products, total } = data;\n\n    if (products.length === 0) {\n      showInfoMessage('No products found matching your search criteria.');\n    } else {\n      appendProducts(homeProducts, products);\n      setTimeout(() => smoothScroll());\n      checkEndOfCollection(total, currentPage);\n      loadMoreBtn.disabled = false;\n    }\n  } catch (error) {\n    showErrorMessage('Oops! Something went wrong. Please try again later.');\n  }\n}\n","//Робота з loacalStorage\nexport function updateLocalStorage(key ,arr) {\nlocalStorage.setItem(key, JSON.stringify(arr));\n}\n","//Описана робота модалки - відкриття закриття і все що з модалкою повʼязано\nimport { renderProductById } from './render-function';\nimport { refs } from './refs';\nconst { modal, addToCartBtn } = refs;\nimport { handleModalClick } from './handlers';\nimport { STORAGE_KEYS } from './constants';\nimport { updateLocalStorage } from './storage';\n\nconst { cart, wishlist } = STORAGE_KEYS;\n\n// відкриття модалки\nexport function openModal() {\n  modal.classList.add('modal--is-open');\n  modal.addEventListener('click', handleModalClick);\n}\n// закриття модалки\nexport function closeModal() {\n  modal.classList.remove('modal--is-open');\n  modal.removeEventListener('click', handleModalClick);\n}\n\n// відкриття модалки за обраним товаром\nexport function openProductModal(event) {\n  const liElement = event.target.closest('.products__item');\n  if (!liElement) return;\n\n  const currentId = Number(liElement.dataset.id);\n\n  if (!currentId) return;\n\n  renderProductById(currentId);\n  openModal();\n}\n\nexport function handleAddToCart(ev) {\n  const productId = Number(addToCartBtn.dataset.id);\n  console.log(productId);\n\n  const idAllProducts = JSON.parse(localStorage.getItem(cart)) ?? [];\n  console.log(idAllProducts);\n  const index = idAllProducts.findIndex(({ id }) => id === productId);\n\n  if (index === -1) {\n    idAllProducts.push(productId);\n\n    idAllProducts.push({ id: productId, qty: 1 });\n\n    console.log(idAllProducts);\n  } else {\n    idAllProducts[index].qty++;\n  }\n  updateLocalStorage(cart, idAllProducts);\n}\nexport function handleAddToWishList(ev) {\n  const productId = Number(ev.target.dataset.id);\n  console.log(productId);\n\n  const wishlistItems = JSON.parse(localStorage.getItem(wishlist)) ?? [];\n  console.log(wishlistItems);\n\n  const index = wishlistItems.findIndex(id => id === productId);\n\n  if (index === -1) {\n    wishlistItems.push({ id: productId });\n    console.log(wishlistItems);\n\n    ev.targettBtn.textContent = 'Remove from Wishlist';\n    console.log(wishlistItems);\n    updateLocalStorage(wishlist, wishlistItems);\n  } else {\n    // Видаляємо з wishlist\n    const updated = wishlistItems.filter(id => id !== productId);\n    updateLocalStorage(wishlist, updated);\n    ev.target.textContent = 'Add to Wishlist';\n    return;\n  }\n\n  updateLocalStorage(wishlist, wishlistItems);\n}\nexport function handleRemoveFromWishList(ev) {}\n","//Логіка сторінки Home\nimport {\n  renderProducts,\n  renderCategories,\n} from './js/render-function';\nimport { refs } from './js/refs';\nimport {\n  showProducts,\n  searchProduct,\n  handleLoadMore,\n} from './js/handlers';\n\nimport { openProductModal } from './js/modal';\n\nconst { homeCategories, form, homeProducts, loadMoreBtn } = refs;\n// логіка для початкової сторінки\nrenderProducts();\nrenderCategories();\n\nhomeCategories.addEventListener('click', showProducts);\nform.addEventListener('submit', searchProduct);\nhomeProducts.addEventListener('click', openProductModal);\nloadMoreBtn.addEventListener('click', handleLoadMore);"],"names":["homeCategories","homeProducts","notFoundDiv","form","refs","query","currentPage","category","showProducts","ev","updateActiveCategoryBtn","clearContent","data","fetchProducts","fetchCategoryProducts","products","total","appendProducts","checkEndOfCollection","error","showErrorMessage","searchProduct","event","fetchSearchResults","renderProducts","handleModalClick","closeBtn","addToCartBtn","addToWishListBtn","closeModal","handleAddToCart","handleAddToWishList","handleLoadMore","loadMoreBtn","hideLoadMoreBtn","showInfoMessage","smoothScroll","updateLocalStorage","key","arr","modal","cart","wishlist","STORAGE_KEYS","openModal","openProductModal","liElement","currentId","renderProductById","productId","idAllProducts","index","id","wishlistItems","updated","renderCategories"],"mappings":"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"}